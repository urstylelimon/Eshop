{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Loriva</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    body {
      padding-top: 56px; /* Mobile-first default padding (h-14) */
      font-family: 'Inter', sans-serif;
    }

    /* Professional animations and effects */
    .nav-link {
      position: relative;
    }
    .nav-link:after {
      content: '';
      position: absolute;
      width: 0;
      height: 2px;
      bottom: -4px;
      left: 50%;
      transform: translateX(-50%);
      background-color: #4f46e5;
      transition: width 0.3s ease;
    }
    .nav-link:hover:after {
      width: 100%;
    }

    /* Enhanced cart badge */
    .cart-count {
      position: absolute;
      top: -6px;
      right: -10px;
      background: linear-gradient(135deg, #4f46e5, #7c3aed);
      color: white;
      font-size: 0.65rem;
      font-weight: 700;
      padding: 2px 5px;
      border-radius: 9999px;
      min-width: 18px;
      text-align: center;
      line-height: 1;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }

    /* Professional icon interactions */
    .nav-icon {
      color: #4b5563;
      transition: color 0.3s ease;
      position: relative;
    }
    .nav-icon:hover {
      color: #4f46e5;
    }

    /* Dropdown menu */
    .dropdown-menu {
      opacity: 0;
      visibility: hidden;
      transform: translateY(10px);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .dropdown:hover .dropdown-menu {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }

    /* Mobile menu */
    .mobile-menu {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: white;
      z-index: 60;
      overflow-y: auto;
      transform: translateX(-100%);
      transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .mobile-menu.active {
      transform: translateX(0);
    }

    .overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        z-index: 55;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.3s ease;
    }

    .overlay.active {
        opacity: 1;
        visibility: visible;
    }

    /* MODIFIED: Added this media query for the taller desktop navbar */
    @media (min-width: 768px) {
      body {
        padding-top: 64px; /* Corresponds to h-16 for desktop */
      }
    }
  </style>
</head>
<body class="bg-gray-50">

  <nav class="bg-white fixed top-0 left-0 right-0 z-50 border-b border-gray-200 shadow-sm">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center h-14 md:h-16">

        <div class="flex items-center">
          <div class="flex-shrink-0">
            <a href="/" class="flex items-center">
              <img class="h-10 w-auto" src="{% static 'images/logo.png' %}" alt="Loriva Logo">
            </a>
          </div>

          <div class="hidden md:ml-10 md:flex md:space-x-8">
            <div class="dropdown relative">
              <a href="#products" class="nav-link text-gray-700 hover:text-indigo-600 px-3 py-2 text-sm font-medium flex items-center">
                Shop <i class="fas fa-chevron-down ml-1 text-xs"></i>
              </a>
              <div class="dropdown-menu absolute z-10 left-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 py-1">
                <a href="#products" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">All Products</a>
                <a href="#products" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">New Arrivals</a>
                <a href="#products" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Bestsellers</a>
              </div>
            </div>
            <a href="#products" class="nav-link text-gray-700 hover:text-indigo-600 px-3 py-2 text-sm font-medium">Deals</a>
            <a href="#products" class="nav-link text-gray-700 hover:text-indigo-600 px-3 py-2 text-sm font-medium">About</a>
          </div>
        </div>

        <div class="flex items-center">

          <div class="hidden md:flex items-center space-x-5">
            <a href="#products" class="nav-icon" aria-label="Search" title="Search">
                <i class="fas fa-search text-lg"></i>
            </a>
            <a href="#products" class="nav-icon" aria-label="Account" title="Account">
              <i class="far fa-user text-lg"></i>
            </a>
            <a href="#products" class="nav-icon" aria-label="Wishlist" title="Wishlist">
              <i class="far fa-heart text-lg"></i>
            </a>
            <a href="{% url 'create_confirm_order' %}" class="nav-icon relative" aria-label="Shopping Cart" title="Cart" onclick="return checkCartAndNavigate(event)">
              <i class="fas fa-shopping-cart text-lg"></i>
              <span class="cart-count">{{ cart_item_count|default:0 }}</span>
            </a>
          </div>

          <div class="md:hidden flex items-center space-x-4">
             <button class="nav-icon" aria-label="Search" title="Search" id="mobile-search-btn">
                <i class="fas fa-search text-xl"></i>
            </button>
            <a href="{% url 'create_confirm_order' %}" class="nav-icon relative" aria-label="Shopping Cart" title="Cart" onclick="return checkCartAndNavigate(event)">
              <i class="fas fa-shopping-cart text-xl"></i>
              <span class="cart-count">{{ cart_item_count|default:0 }}</span>
            </a>
            <button class="mobile-menu-button nav-icon" aria-label="Menu">
              <i class="fas fa-bars text-xl"></i>
            </button>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <div class="mobile-menu md:hidden">
      <div class="flex justify-between items-center p-4 border-b">
        <h2 class="font-bold text-lg">Menu</h2>
        <button class="mobile-menu-close text-2xl">&times;</button>
      </div>
      <div class="p-4">
        <div class="relative mb-4">
          <input type="text" placeholder="Search products..." class="w-full pl-10 pr-4 py-2 border rounded-full">
          <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
        </div>
        <a href="#products" class="block py-2 px-3 hover:bg-gray-100 rounded">Shop</a>
        <a href="#products" class="block py-2 px-3 hover:bg-gray-100 rounded">Deals</a>
        <a href="#products" class="block py-2 px-3 hover:bg-gray-100 rounded">About Us</a>
        <hr class="my-4">
        <a href="#products" class="block py-2 px-3 hover:bg-gray-100 rounded">My Account</a>
        <a href="#products" class="block py-2 px-3 hover:bg-gray-100 rounded">Wishlist</a>
      </div>
  </div>

  <div class="overlay"></div>

  <div id="desktop-cart-message" style="display:none; position:fixed; top:80px; right:20px; background:#dc2626; color:white; padding:1rem; border-radius:8px; font-weight:500; box-shadow:0 4px 10px rgba(0,0,0,0.2); z-index:2000; opacity:0; transition:opacity 0.3s ease-out, transform 0.3s ease-out; transform: translateY(-20px);">
      Your cart is empty. Please add items first.
  </div>
  <div id="mobile-cart-message" style="display:none; position:fixed; bottom:20px; left:50%; transform:translateX(-50%); background:#dc2626; color:white; padding:0.75rem 1rem; border-radius:9999px; font-size:14px; box-shadow:0 2px 6px rgba(0,0,0,0.2); z-index:1000; opacity:0; transition:opacity 0.3s ease-out, transform 0.3s ease-out; transform: translateY(20px);">
      Your cart is empty.
  </div>

  <script>
    // Mobile menu toggle logic
    const mobileMenuButton = document.querySelector('.mobile-menu-button');
    const mobileMenu = document.querySelector('.mobile-menu');
    const mobileMenuClose = document.querySelector('.mobile-menu-close');
    const overlay = document.querySelector('.overlay');

    function openMobileMenu() {
      mobileMenu.classList.add('active');
      overlay.classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    function closeMobileMenu() {
      mobileMenu.classList.remove('active');
      overlay.classList.remove('active');
      document.body.style.overflow = 'auto';
    }

    if (mobileMenuButton) mobileMenuButton.addEventListener('click', openMobileMenu);
    if (mobileMenuClose) mobileMenuClose.addEventListener('click', closeMobileMenu);
    if (overlay) overlay.addEventListener('click', closeMobileMenu);

    // Open mobile menu and focus search when mobile search icon is clicked
    const mobileSearchBtn = document.getElementById('mobile-search-btn');
    if (mobileSearchBtn) {
      mobileSearchBtn.addEventListener('click', function(e) {
        e.preventDefault();
        openMobileMenu();
        setTimeout(() => {
          const searchInput = mobileMenu.querySelector('input[type="text"]');
          if (searchInput) searchInput.focus();
        }, 300);
      });
    }

    // Function to show toast messages
    function showToast(id) {
        const toast = document.getElementById(id);
        if (!toast) return;

        toast.style.display = "block";
        setTimeout(() => { // Allow display block to apply before transitioning
            toast.style.opacity = "1";
            toast.style.transform = "translateX(-50%) translateY(0)"; // Adjust for mobile
            if(id === 'desktop-cart-message') toast.style.transform = "translateY(0)";
        }, 50);

        setTimeout(() => {
            toast.style.opacity = "0";
            toast.style.transform = (id === 'desktop-cart-message') ? "translateY(-20px)" : "translateX(-50%) translateY(20px)";
            setTimeout(() => { toast.style.display = "none"; }, 300);
        }, 3000);
    }

    // Check cart and navigate function
    function checkCartAndNavigate(event) {
        const cartCountElement = document.querySelector('a[aria-label="Shopping Cart"] .cart-count');
        const currentCartCount = parseInt(cartCountElement.textContent) || 0;

        if (currentCartCount === 0) {
            event.preventDefault();
            event.stopPropagation();
            if (window.innerWidth >= 768) {
                showToast('desktop-cart-message');
            } else {
                showToast('mobile-cart-message');
            }
            return false;
        }
        return true;
    }

    // Listen for cart updates from any page
    window.addEventListener('cartUpdate', function(event) {
        const newCount = event.detail.count;
        const cartCountElements = document.querySelectorAll('.cart-count');
        cartCountElements.forEach(element => {
            element.textContent = newCount;
        });
    });
  </script>

</body>
</html>